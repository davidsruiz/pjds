/*!
 * Proton v2.2.1
 * https://github.com/a-jie/Proton
 *
 * Copyright 2011-2017, A-JIE
 * Licensed under the MIT license
 * http://www.opensource.org/licenses/mit-license
 *
 */
(function(a,b){typeof define=="function"&&define.amd?define([],b):typeof module!="undefined"&&module.exports?module.exports=b():a.Proton=b()})(this,function(){function be(a,b,c,d){be._super_.call(this),this.reset(a,b,c,d)}function bd(a,b,c,d){bd._super_.call(this),this.x=a,this.y=b,this.width=c,this.height=d}function bc(a,b){bc._super_.call(this),this.x=a,this.y=b}function bb(a,b,c){bb._super_.call(this),this.x=a,this.y=b,this.radius=c,this.angle=0,this.center={x:this.x,y:this.y}}function ba(b,c,d,e,f){ba._super_.call(this),d-b>=0?(this.x1=b,this.y1=c,this.x2=d,this.y2=e):(this.x1=d,this.y1=e,this.x2=b,this.y2=c),this.dx=this.x2-this.x1,this.dy=this.y2-this.y1,this.minx=Math.min(this.x1,this.x2),this.miny=Math.min(this.y1,this.y2),this.maxx=Math.max(this.x1,this.x2),this.maxy=Math.max(this.y1,this.y2),this.dot=this.x2*this.y1-this.x1*this.y2,this.xxyy=this.dx*this.dx+this.dy*this.dy,this.gradient=this.getGradient(),this.length=this.getLength(),this.direction=a.Util.initValue(f,">")}function _(){this.vector=new a.Vector2D(0,0),this.random=0,this.crossType="dead",this.alert=!0}function $(a,b){$._super_.call(this,a,b),this.gl=this.element.getContext("experimental-webgl",{antialias:!0,stencil:!1,depth:!1}),this.gl||alert("Sorry your browser do not suppest WebGL!"),this.initVar(),this.setMaxRadius(),this.initShaders(),this.initBuffers(),this.gl.blendEquation(this.gl.FUNC_ADD),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.enable(this.gl.BLEND)}function Z(a,b,c){Z._super_.call(this,a,b),this.context=this.element.getContext("2d"),this.imageData=null,this.rectangle=null,this.rectangle=c,this.createImageData(c)}function Y(a,b){Y._super_.call(this,a,b),this.stroke=null,this.context=this.element.getContext("2d"),this.bufferCache={}}function X(a,b,c){X._super_.call(this,a,b),this.stroke=c}function W(a,b){W._super_.call(this,a,b),this.stroke=null}function V(b,c,d){this.proton=b,this.element=c,this.stroke=d,this.pool=new a.Pool}function U(b,c,d){this.element=d,this.type=a.Util.initValue(b,"canvas"),this.proton=c,this.renderer=this.getRenderer()}function R(b,c,d){this.mouseTarget=a.Util.initValue(b,window),this.ease=a.Util.initValue(c,.7),this._allowEmitting=!1,this.initEventHandler(),R._super_.call(this,d)}function Q(a){this.selfBehaviours=[],Q._super_.call(this,a)}function P(b){this.initializes=[],this.particles=[],this.behaviours=[],this.emitTime=0,this.emitTotalTimes=-1,this.damping=.006,this.bindEmitter=!0,this.rate=new a.Rate(1,.1),P._super_.call(this,b),this.id="emitter_"+P.ID++}function O(b,c,d,e){O._super_.call(this,d,e),this.distanceVec=new a.Vector2D,this.centerPoint=a.Util.initValue(b,new a.Vector2D),this.force=a.Util.initValue(this.normalizeValue(c),100),this.name="GravityWell"}function N(a,b,c,d){N._super_.call(this,c,d),this.reset(a,b),this.name="Color"}function M(a,b,c,d,e){M._super_.call(this,d,e),this.reset(a,b,c),this.name="Rotate"}function L(a,b,c,d){L._super_.call(this,c,d),this.reset(a,b),this.name="Scale"}function K(a,b,c,d){K._super_.call(this,c,d),this.reset(a,b),this.name="Alpha"}function J(a,b,c,d){J._super_.call(this,c,d),this.reset(a,b),this.name="CrossZone"}function I(a,b,c,d,e){I._super_.call(this,d,e),this.reset(a,b,c),this.name="Collision"}function H(a,b,c){H._super_.call(this,0,a,b,c),this.name="Gravity"}function G(a,b,c,d,e){G._super_.call(this,a,b,c,d,e),this.force*=-1,this.name="Repulsion"}function F(a,b,c,d,e){F._super_.call(this,d,e),this.reset(a,b,c),this.time=0,this.name="RandomDrift"}function E(b,c,d,e,f){E._super_.call(this,e,f),this.targetPosition=a.Util.initValue(b,new a.Vector2D),this.radius=a.Util.initValue(d,1e3),this.force=a.Util.initValue(this.normalizeValue(c),100),this.radiusSq=this.radius*this.radius,this.attractionForce=new a.Vector2D,this.lengthSq=0,this.name="Attraction"}function D(b,c,d,e){D._super_.call(this,d,e),this.force=this.normalizeForce(new a.Vector2D(b,c)),this.name="Force"}function C(b,c,d){C._super_.call(this),this.image=this.setSpanValue(b),this.w=a.Util.initValue(c,20),this.h=a.Util.initValue(d,this.w)}function B(b,c,d){B._super_.call(this),this.radius=a.Util.setSpanValue(b,c,d)}function A(b,c,d){A._super_.call(this),this.massPan=a.Util.setSpanValue(b,c,d)}function z(b,c,d){z._super_.call(this),this.rPan=a.Util.setSpanValue(b),this.thaPan=a.Util.setSpanValue(c),this.type=a.Util.initValue(d,"vector")}function y(b){y._super_.call(this),this.zone=a.Util.initValue(b,new a.PointZone)}function x(b,c,d){x._super_.call(this),this.lifePan=a.Util.setSpanValue(b,c,d)}function v(){}function u(b,c){this.numPan=a.Util.initValue(b,1),this.timePan=a.Util.initValue(c,1),this.numPan=a.Util.setSpanValue(this.numPan),this.timePan=a.Util.setSpanValue(this.timePan),this.startTime=0,this.nextTime=0,this.init()}function t(b,c){this.id="Behaviour_"+t.id++,this.life=a.Util.initValue(b,Infinity),this.easing=a.ease.setEasingByName(c),this.age=0,this.energy=1,this.dead=!1,this.parents=[],this.name="Behaviour"}function r(a,b,c,d){this.x=a,this.y=b,this.width=c,this.height=d,this.bottom=this.y+this.height,this.right=this.x+this.width}function q(b){a.Util.isArray(b)?this.colorArr=b:this.colorArr=[b]}function p(b,c,d){this.isArray=!1,a.Util.isArray(b)?(this.isArray=!0,this.a=b):(this.a=a.Util.initValue(b,1),this.b=a.Util.initValue(c,this.a),this.center=a.Util.initValue(d,!1))}function i(){this.cID=0,this.list={}}function h(b){this.id="particle_"+h.ID++,this.reset(!0),a.Util.setPrototypeByObject(this,b)}function g(){this.mats=[],this.size=0;for(var b=0;b<20;b++)this.mats.push(a.Mat3.create([0,0,0,0,0,0,0,0,0]))}function b(){this.initialize()}function a(b,c){this.integrationType=a.Util.initValue(c,a.EULER),this.emitters=[],this.renderers=[],this.time=0,this.oldTime=0,a.pool=new a.Pool(100),a.integrator=new a.NumericalIntegration(this.integrationType)}a.POOL_MAX=1e3,a.TIME_STEP=60,a.USE_CLOCK=!1,a.MEASURE=100,a.EULER="euler",a.RK2="runge-kutta2",a.VERLET="verlet",a.PARTICLE_CREATED="partilcleCreated",a.PARTICLE_UPDATE="partilcleUpdate",a.PARTICLE_SLEEP="particleSleep",a.PARTICLE_DEAD="partilcleDead",a.PROTON_UPDATE="protonUpdate",a.PROTON_UPDATE_AFTER="protonUpdateAfter",a.EMITTER_ADDED="emitterAdded",a.EMITTER_REMOVED="emitterRemoved",a.amendChangeTabsBug=!0,a.TextureBuffer={},a.TextureCanvasBuffer={},a.prototype={addRender:function(a){a.proton=this,this.renderers.push(a.proton)},addEmitter:function(b){this.emitters.push(b),b.parent=this,this.dispatchEvent(a.EMITTER_ADDED,b)},removeEmitter:function(b){var c=this.emitters.indexOf(b);this.emitters.splice(c,1),b.parent=null,this.dispatchEvent(a.EMITTER_REMOVED,b)},update:function(){this.dispatchEvent(a.PROTON_UPDATE);if(a.USE_CLOCK){this.oldTime||(this.oldTime=(new Date).getTime());var b=(new Date).getTime();this.elapsed=(b-this.oldTime)/1e3,a.amendChangeTabsBug&&this.amendChangeTabsBug(),this.oldTime=b}else this.elapsed=.0167;if(this.elapsed>0)for(var c=0;c<this.emitters.length;c++)this.emitters[c].update(this.elapsed);this.dispatchEvent(a.PROTON_UPDATE_AFTER)},amendChangeTabsBug:function(){this.elapsed>.5&&(this.oldTime=(new Date).getTime(),this.elapsed=0)},getCount:function(){var a=0,b=this.emitters.length;for(var c=0;c<b;c++)a+=this.emitters[c].particles.length;return a},destroy:function(){var b=this.emitters.length;for(var c=0;c<b;c++)this.emitters[c].destroy(),delete this.emitters[c];this.emitters=[],this.time=0,this.oldTime=0,a.pool.release()}},b.initialize=function(a){a.addEventListener=c.addEventListener,a.removeEventListener=c.removeEventListener,a.removeAllEventListeners=c.removeAllEventListeners,a.hasEventListener=c.hasEventListener,a.dispatchEvent=c.dispatchEvent};var c=b.prototype;c._listeners=null,c.initialize=function(){},c.addEventListener=function(a,b){this._listeners?this.removeEventListener(a,b):this._listeners={},this._listeners[a]||(this._listeners[a]=[]),this._listeners[a].push(b);return b},c.removeEventListener=function(a,b){if(!!this._listeners){if(!this._listeners[a])return;var c=this._listeners[a];for(var d=0,e=c.length;d<e;d++)if(c[d]==b){e==1?delete this._listeners[a]:c.splice(d,1);break}}},c.removeAllEventListeners=function(a){a?this._listeners&&delete this._listeners[a]:this._listeners=null},c.dispatchEvent=function(a,b){var c=!1,d=this._listeners;if(a&&d){var e=d[a];if(!e)return c;e=e.slice();var f,g=e.length;while(g--){var f=e[g];c=c||f(b)}}return!!c},c.hasEventListener=function(a){var b=this._listeners;return!!b&&!!b[a]},b.initialize(a.prototype),a.EventDispatcher=b;var d=d||{initValue:function(a,b){var a=a!=null&&a!=undefined?a:b;return a},isArray:function(a){return typeof a=="object"&&a.hasOwnProperty("length")},destroyArray:function(a){a.length=0},destroyObject:function(a){for(var b in a)delete a[b]},getVector2D:function(b,c){if(typeof b=="object")return b;var d=new a.Vector2D(b,c);return d},classApply:function(a,b){if(!b)return new a;var c=[null].concat(b),d=a.bind.apply(a,c);return new d},judgeVector2D:function(a){var b="";if(a.hasOwnProperty("x")||a.hasOwnProperty("y")||a.hasOwnProperty("p")||a.hasOwnProperty("position"))b+="p";if(a.hasOwnProperty("vx")||a.hasOwnProperty("vx")||a.hasOwnProperty("v")||a.hasOwnProperty("velocity"))b+="v";if(a.hasOwnProperty("ax")||a.hasOwnProperty("ax")||a.hasOwnProperty("a")||a.hasOwnProperty("accelerate"))b+="a";return b},setVector2DByObject:function(a,b){b.hasOwnProperty("x")&&(a.p.x=b.x),b.hasOwnProperty("y")&&(a.p.y=b.y),b.hasOwnProperty("vx")&&(a.v.x=b.vx),b.hasOwnProperty("vy")&&(a.v.y=b.vy),b.hasOwnProperty("ax")&&(a.a.x=b.ax),b.hasOwnProperty("ay")&&(a.a.y=b.ay),b.hasOwnProperty("p")&&particle.p.copy(b.p),b.hasOwnProperty("v")&&particle.v.copy(b.v),b.hasOwnProperty("a")&&particle.a.copy(b.a),b.hasOwnProperty("position")&&particle.p.copy(b.position),b.hasOwnProperty("velocity")&&particle.v.copy(b.velocity),b.hasOwnProperty("accelerate")&&particle.a.copy(b.accelerate)},addPrototypeByObject:function(b,c,d){for(var e in c)d?d.indexOf(e)<0&&(b[e]=a.Util.getSpanValue(c[e])):b[e]=a.Util.getSpanValue(c[e]);return b},setPrototypeByObject:function(b,c,d){for(var e in c)b.hasOwnProperty(e)&&(d?d.indexOf(e)<0&&(b[e]=a.Util.getSpanValue(c[e])):b[e]=a.Util.getSpanValue(c[e]));return b},setSpanValue:function(b,c,d){return b instanceof a.Span?b:c?d?new a.Span(b,c,d):new a.Span(b,c):new a.Span(b)},getSpanValue:function(b){return b instanceof a.Span?b.getValue():b},inherits:function(a,b){a._super_=b;if(Object.create)a.prototype=Object.create(b.prototype,{constructor:{value:a}});else{var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}},getImageData:function(a,b,c){a.drawImage(b,c.x,c.y);var d=a.getImageData(c.x,c.y,c.width,c.height);a.clearRect(c.x,c.y,c.width,c.height);return d},getImage:function(a,b,c,d){typeof a=="string"?this.loadAndSetImage(a,b,c,d):typeof a=="object"?this.loadAndSetImage(a.src,b,c,d):a instanceof Image&&this.loadedImage(a.src,b,c,d,a)},loadedImage:function(b,c,d,e,f){c.target=f,c.transform.src=b,a.TextureBuffer[b]||(a.TextureBuffer[b]=c.target);if(d)if(a.TextureCanvasBuffer[b])c.transform.canvas=a.TextureCanvasBuffer[b];else{var g=a.WebGLUtil.nhpot(c.target.width),h=a.WebGLUtil.nhpot(c.target.height);c.transform.canvas=a.DomUtil.createCanvas("canvas"+b,g,h);var i=c.transform.canvas.getContext("2d");i.drawImage(c.target,0,0,c.target.width,c.target.height),a.TextureCanvasBuffer[b]=c.transform.canvas}e&&e(c)},loadAndSetImage:function(b,c,d,e){if(a.TextureBuffer[b])this.loadedImage(b,c,d,e,a.TextureBuffer[b]);else{var f=this,g=new Image;g.onload=function(a){f.loadedImage(b,c,d,e,a.target)},g.src=b}},hexToRGB:function(a){var b=a.charAt(0)=="#"?a.substring(1,7):a,c=parseInt(b.substring(0,2),16),d=parseInt(b.substring(2,4),16),e=parseInt(b.substring(4,6),16);return{r:c,g:d,b:e}},rgbToHex:function(a){return"rgb("+a.r+", "+a.g+", "+a.b+")"}};a.Util=d,Function.prototype.bind||(Function.prototype.bind=function(a){if(typeof this!="function")throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=Array.prototype.slice.call(arguments,1),c=this,d=function(){},e=function(){return c.apply(this instanceof d?this:a||this,b.concat(Array.prototype.slice.call(arguments)))};d.prototype=this.prototype,e.prototype=new d;return e});var e=e||{ipot:function(a){return(a&a-1)==0},nhpot:function(a){--a;for(var b=1;b<32;b<<=1)a=a|a>>b;return a+1},makeTranslation:function(a,b){return[1,0,0,0,1,0,a,b,1]},makeRotation:function(a){var b=Math.cos(a),c=Math.sin(a);return[b,-c,0,c,b,0,0,0,1]},makeScale:function(a,b){return[a,0,0,0,b,0,0,0,1]},matrixMultiply:function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],i=a[6],j=a[7],k=a[8],l=b[0],m=b[1],n=b[2],o=b[3],p=b[4],q=b[5],r=b[6],s=b[7],t=b[8];return[c*l+d*o+e*r,c*m+d*p+e*s,c*n+d*q+e*t,f*l+g*o+h*r,f*m+g*p+h*s,f*n+g*q+h*t,i*l+j*o+k*r,i*m+j*p+k*s,i*n+j*q+k*t]}};a.WebGLUtil=e;var f=f||{createCanvas:function(a,b,c,d){var e=document.createElement("canvas"),f=d?d:"absolute";e.id=a,e.width=b,e.height=c,e.style.position=f,e.style.opacity=0,this.transformDom(e,-500,-500,0,0);return e},transformDom:function(a,b,c,d,e){a.style.WebkitTransform="translate("+b+"px, "+c+"px) "+"scale("+d+") "+"rotate("+e+"deg)",a.style.MozTransform="translate("+b+"px, "+c+"px) "+"scale("+d+") "+"rotate("+e+"deg)",a.style.OTransform="translate("+b+"px, "+c+"px) "+"scale("+d+") "+"rotate("+e+"deg)",a.style.msTransform="translate("+b+"px, "+c+"px) "+"scale("+d+") "+"rotate("+e+"deg)",a.style.transform="translate("+b+"px, "+c+"px) "+"scale("+d+") "+"rotate("+e+"deg)"}};a.DomUtil=f,g.prototype.set=function(b,c){c==0?a.Mat3.set(b,this.mats[0]):a.Mat3.multiply(this.mats[c-1],b,this.mats[c]),this.size=Math.max(this.size,c+1)},g.prototype.push=function(b){this.size==0?a.Mat3.set(b,this.mats[0]):a.Mat3.multiply(this.mats[this.size-1],b,this.mats[this.size]),this.size++},g.prototype.pop=function(){this.size>0&&this.size--},g.prototype.top=function(){return this.mats[this.size-1]},a.MStack=g,h.ID=0,h.prototype={getDirection:function(){return Math.atan2(this.v.x,-this.v.y)*(180/Math.PI)},reset:function(b){this.life=Infinity,this.age=0,this.energy=1,this.dead=!1,this.sleep=!1,this.target=null,this.sprite=null,this.parent=null,this.mass=1,this.radius=10,this.alpha=1,this.scale=1,this.rotation=0,this.color=null,this.easing=a.ease.setEasingByName(a.easeLinear),b?(this.transform={},this.p=new a.Vector2D,this.v=new a.Vector2D,this.a=new a.Vector2D,this.old={p:new a.Vector2D,v:new a.Vector2D,a:new a.Vector2D},this.behaviours=[]):(a.Util.destroyObject(this.transform),this.p.set(0,0),this.v.set(0,0),this.a.set(0,0),this.old.p.set(0,0),this.old.v.set(0,0),this.old.a.set(0,0),this.removeAllBehaviours()),this.transform.rgb={r:255,g:255,b:255};return this},update:function(a,b){if(!this.sleep){this.age+=a;var c=this.behaviours.length,d;for(d=0;d<c;d++)this.behaviours[d]&&this.behaviours[d].applyBehaviour(this,a,b)}if(this.age>=this.life)this.destroy();else{var e=this.easing(this.age/this.life);this.energy=Math.max(1-e,0)}},addBehaviour:function(a){this.behaviours.push(a),a.hasOwnProperty("parents")&&a.parents.push(this),a.initialize(this)},addBehaviours:function(a){var b=a.length,c;for(c=0;c<b;c++)this.addBehaviour(a[c])},removeBehaviour:function(a){var b=this.behaviours.indexOf(a);if(b>-1){var a=this.behaviours.splice(b,1);a.parents=null}},removeAllBehaviours:function(){a.Util.destroyArray(this.behaviours)},destroy:function(){this.removeAllBehaviours(),this.energy=0,this.dead=!0,this.parent=null}},a.Particle=h,i.prototype={create:function(b,c){this.cID++;return typeof b=="function"?a.Util.classApply(b,c):b.clone()},getCount:function(){var a=0;for(var b in this.list)a+=this.list[b].length;return a++},get:function(a,b){var c,d=a.__puid||j.id(a);this.list[d]&&this.list[d].length>0?c=this.list[d].pop():c=this.create(a,b),c.__puid=a.__puid||d;return c},set:function(a){return this._getList(a.__puid).push(a)},destroy:function(){for(var a in this.list)this.list[a].length=0,delete this.list[a]},_getList:function(a){a=a||"default",this.list[a]||(this.list[a]=[]);return this.list[a]}},a.Pool=i;var j={_id:0,_uids:{},id:function(a){for(var b in this._uids)if(this._uids[b]==a)return b;var c="PUID_"+this._id++;this._uids[c]=a;return c},hash:function(a){return}},k={randomAToB:function(a,b,c){return c?Math.floor(Math.random()*(b-a))+a:a+Math.random()*(b-a)},randomFloating:function(a,b,c){return k.randomAToB(a-b,a+b,c)},randomZone:function(a){},degreeTransform:function(a){return a*Math.PI/180},toColor16:function(a){return"#"+a.toString(16)},randomColor:function(){return"#"+("00000"+(Math.random()*16777216<<0).toString(16)).slice(-6)}};a.MathUtils=k;var m=function(b){this.type=a.Util.initValue(b,a.EULER)};m.prototype={integrate:function(a,b,c){this.eulerIntegrate(a,b,c)},eulerIntegrate:function(a,b,c){a.sleep||(a.old.p.copy(a.p),a.old.v.copy(a.v),a.a.multiplyScalar(1/a.mass),a.v.add(a.a.multiplyScalar(b)),a.p.add(a.old.v.multiplyScalar(b)),c&&a.v.multiplyScalar(c),a.a.clear())}},a.NumericalIntegration=m;var n=function(a,b){this.x=a||0,this.y=b||0};n.prototype={set:function(a,b){this.x=a,this.y=b;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},getGradient:function(){if(this.x!=0)return Math.atan2(this.y,this.x);if(this.y>0)return Math.PI/2;if(this.y<0)return-Math.PI/2},copy:function(a){this.x=a.x,this.y=a.y;return this},add:function(a,b){if(b!==undefined)return this.addVectors(a,b);this.x+=a.x,this.y+=a.y;return this},addXY:function(a,b){this.x+=a,this.y+=b;return this},addVectors:function(a,b){this.x=a.x+b.x,this.y=a.y+b.y;return this},addScalar:function(a){this.x+=a,this.y+=a;return this},sub:function(a,b){if(b!==undefined)return this.subVectors(a,b);this.x-=a.x,this.y-=a.y;return this},subVectors:function(a,b){this.x=a.x-b.x,this.y=a.y-b.y;return this},multiplyScalar:function(a){this.x*=a,this.y*=a;return this},divideScalar:function(a){a!==0?(this.x/=a,this.y/=a):this.set(0,0);return this},min:function(a){this.x>a.x&&(this.x=a.x),this.y>a.y&&(this.y=a.y);return this},max:function(a){this.x<a.x&&(this.x=a.x),this.y<a.y&&(this.y=a.y);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(a){return this.x*a.x+this.y*a.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},rotate:function(a){var b=this.x,c=this.y;this.x=b*Math.cos(a)+c*Math.sin(a),this.y=-b*Math.sin(a)+c*Math.cos(a);return this},distanceToSquared:function(a){var b=this.x-a.x,c=this.y-a.y;return b*b+c*c},setLength:function(a){var b=this.length();b!==0&&a!==b&&this.multiplyScalar(a/b);return this},lerp:function(a,b){this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b;return this},equals:function(a){return a.x===this.x&&a.y===this.y},toArray:function(){return[this.x,this.y]},clear:function(){this.x=0,this.y=0;return this},clone:function(){return new a.Vector2D(this.x,this.y)}},a.Vector2D=n;var o=function(a,b){this.r=Math.abs(a)||0,this.tha=b||0};o.prototype={set:function(a,b){this.r=a,this.tha=b;return this},setR:function(a){this.r=a;return this},setTha:function(a){this.tha=a;return this},copy:function(a){this.r=a.r,this.tha=a.tha;return this},toVector:function(){return new a.Vector2D(this.getX(),this.getY())},getX:function(){return this.r*Math.sin(this.tha)},getY:function(){return-this.r*Math.cos(this.tha)},normalize:function(){this.r=1;return this},equals:function(a){return a.r===this.r&&a.tha===this.tha},toArray:function(){return[this.r,this.tha]},clear:function(){this.r=0,this.tha=0;return this},clone:function(){return new a.Polar2D(this.r,this.tha)}},a.Polar2D=o,p.prototype={getValue:function(b){return this.isArray?this.a[Math.floor(this.a.length*Math.random())]:this.center?a.MathUtils.randomFloating(this.a,this.b,b):a.MathUtils.randomAToB(this.a,this.b,b)}},a.Span=p,a.getSpan=function(b,c,d){return new a.Span(b,c,d)},a.Util.inherits(q,a.Span),q.prototype.getValue=function(){var b=this.colorArr[Math.floor(this.colorArr.length*Math.random())];return b=="random"||b=="Random"?a.MathUtils.randomColor():b},a.ColorSpan=q,r.prototype={contains:function(a,b){return a<=this.right&&a>=this.x&&b<=this.bottom&&b>=this.y?!0:!1}},a.Rectangle=r;var s=s||{create:function(a){var b=new Float32Array(9);a&&this.set(a,b);return b},set:function(a,b){for(var c=0;c<9;c++)b[c]=a[c];return b},multiply:function(a,b,c){var d=a[0],e=a[1],f=a[2],g=a[3],h=a[4],i=a[6],j=a[7],k=b[0],l=b[1],m=b[2],n=b[3],o=b[4],p=b[6],q=b[7];c[0]=k*d+l*g,c[1]=k*e+l*h,c[2]=f*m,c[3]=n*d+o*g,c[4]=n*e+o*h,c[6]=p*d+q*g+i,c[7]=p*e+q*h+j;return c},inverse:function(a,b){var c=a[0],d=a[1],e=a[3],f=a[4],g=a[6],h=a[7],i=f,j=-e,k=h*e-f*g,l=c*i+d*j,m;m=1/l,b[0]=i*m,b[1]=-d*m,b[3]=j*m,b[4]=c*m,b[6]=k*m,b[7]=(-h*c+d*g)*m;return b},multiplyVec2:function(a,b,c){var d=b[0],e=b[1];c[0]=d*a[0]+e*a[3]+a[6],c[1]=d*a[1]+e*a[4]+a[7];return c}};a.Mat3=s,t.id=0,t.prototype={reset:function(b,c){this.life=a.Util.initValue(b,Infinity),this.easing=a.Util.initValue(c,a.ease.setEasingByName(a.easeLinear))},normalizeForce:function(b){return b.multiplyScalar(a.MEASURE)},normalizeValue:function(b){return b*a.MEASURE},initialize:function(a){},applyBehaviour:function(a,b,c){this.age+=b;if(this.age>=this.life||this.dead)this.energy=0,this.dead=!0,this.destroy();else{var d=this.easing(a.age/a.life);this.energy=Math.max(1-d,0)}},destroy:function(){var a,b=this.parents.length,c;for(c=0;c<b;c++)this.parents[c].removeBehaviour(this);this.parents=[]}},a.Behaviour=t,u.prototype={init:function(){this.startTime=0,this.nextTime=this.timePan.getValue()},getValue:function(a){this.startTime+=a;if(this.startTime>=this.nextTime){this.startTime=0,this.nextTime=this.timePan.getValue();return this.numPan.b==1?this.numPan.getValue(!1)>.5?1:0:this.numPan.getValue(!0)}return 0}},a.Rate=u,v.prototype.reset=function(){},v.prototype.init=function(a,b){b?this.initialize(b):this.initialize(a)},v.prototype.initialize=function(a){},a.Initialize=v;var w={initialize:function(b,c,d){var e=d.length,f;for(f=0;f<e;f++)d[f]instanceof a.Initialize?d[f].init(b,c):a.InitializeUtil.init(b,c,d[f]);a.InitializeUtil.bindEmitter(b,c)},init:function(b,c,d){a.Util.setPrototypeByObject(c,d),a.Util.setVector2DByObject(c,d)},bindEmitter:function(b,c){b.bindEmitter&&(c.p.add(b.p),c.v.add(b.v),c.a.add(b.a),c.v.rotate(a.MathUtils.degreeTransform(b.rotation)))}};a.InitializeUtil=w,a.Util.inherits(x,a.Initialize),x.prototype.initialize=function(a){this.lifePan.a==Infinity?a.life=Infinity:a.life=this.lifePan.getValue()},a.Life=x,a.Util.inherits(y,a.Initialize),y.prototype.reset=function(b){this.zone=a.Util.initValue(b,new a.PointZone)},y.prototype.initialize=function(a){this.zone.getPosition(),a.p.x=this.zone.vector.x,a.p.y=this.zone.vector.y},a.Position=y,a.P=y,a.Util.inherits(z,a.Initialize),z.prototype.reset=function(b,c,d){this.rPan=a.Util.setSpanValue(b),this.thaPan=a.Util.setSpanValue(c),this.type=a.Util.initValue(d,"vector")},z.prototype.normalizeVelocity=function(b){return b*a.MEASURE},z.prototype.initialize=function(b){if(this.type=="p"||this.type=="P"||this.type=="polar"){var c=new a.Polar2D(this.normalizeVelocity(this.rPan.getValue()),this.thaPan.getValue()*Math.PI/180);b.v.x=c.getX(),b.v.y=c.getY()}else b.v.x=this.normalizeVelocity(this.rPan.getValue()),b.v.y=this.normalizeVelocity(this.thaPan.getValue())},a.Velocity=z,a.V=z,a.Util.inherits(A,a.Initialize),A.prototype.initialize=function(a){a.mass=this.massPan.getValue()},a.Mass=A,a.Util.inherits(B,a.Initialize),B.prototype.reset=function(b,c,d){this.radius=a.Util.setSpanValue(b,c,d)},B.prototype.initialize=function(a){a.radius=this.radius.getValue(),a.transform.oldRadius=a.radius},a.Radius=B,a.Util.inherits(C,a.Initialize),C.prototype.initialize=function(a){var b=this.image.getValue();typeof b=="string"?a.target={width:this.w,height:this.h,src:b}:a.target=b},C.prototype.setSpanValue=function(b){return b instanceof a.ColorSpan?b:new a.ColorSpan(b)},a.ImageTarget=C,a.Util.inherits(D,a.Behaviour),D.prototype.reset=function(b,c,d,e){this.force=this.normalizeForce(new a.Vector2D(b,c)),d&&D._super_.prototype.reset.call(this,d,e)},D.prototype.applyBehaviour=function(a,b,c){D._super_.prototype.applyBehaviour.call(this,a,b,c),a.a.add(this.force)},a.Force=D,a.F=D,a.Util.inherits(E,a.Behaviour),E.prototype.reset=function(b,c,d,e,f){this.targetPosition=a.Util.initValue(b,new a.Vector2D),this.radius=a.Util.initValue(d,1e3),this.force=a.Util.initValue(this.normalizeValue(c),100),this.radiusSq=this.radius*this.radius,this.attractionForce=new a.Vector2D,this.lengthSq=0,e&&E._super_.prototype.reset.call(this,e,f)},E.prototype.applyBehaviour=function(a,b,c){E._super_.prototype.applyBehaviour.call(this,a,b,c),this.attractionForce.copy(this.targetPosition),this.attractionForce.sub(a.p),this.lengthSq=this.attractionForce.lengthSq(),this.lengthSq>4e-6&&this.lengthSq<this.radiusSq&&(this.attractionForce.normalize(),this.attractionForce.multiplyScalar(1-this.lengthSq/this.radiusSq),this.attractionForce.multiplyScalar(this.force),a.a.add(this.attractionForce))},a.Attraction=E,a.Util.inherits(F,a.Behaviour),F.prototype.reset=function(b,c,d,e,f){this.panFoce=new a.Vector2D(b,c),this.panFoce=this.normalizeForce(this.panFoce),this.delay=d,e&&F._super_.prototype.reset.call(this,e,f)},F.prototype.applyBehaviour=function(b,c,d){F._super_.prototype.applyBehaviour.call(this,b,c,d),this.time+=c,this.time>=this.delay&&(b.a.addXY(a.MathUtils.randomAToB(-this.panFoce.x,this.panFoce.x),a.MathUtils.randomAToB(-this.panFoce.y,this.panFoce.y)),this.time=0)},a.RandomDrift=F,a.Util.inherits(G,a.Attraction),G.prototype.reset=function(a,b,c,d,e){G._super_.prototype.reset.call(this,a,b,c,d,e),this.force*=-1},a.Repulsion=G,a.Util.inherits(H,a.Force),H.prototype.reset=function(a,b,c){H._super_.prototype.reset.call(this,0,a,b,c)},a.Gravity=H,a.G=H,a.Util.inherits(I,a.Behaviour),I.prototype.reset=function(b,c,d,e,f){this.emitter=a.Util.initValue(b,null),this.mass=a.Util.initValue(c,!0),this.callback=a.Util.initValue(d,null),this.collisionPool=[],this.delta=new a.Vector2D,e&&I._super_.prototype.reset.call(this,e,f)},I.prototype.applyBehaviour=function(a,b,c){var d=this.emitter?this.emitter.particles.slice(c):this.pool.slice(c),e,f,g,h,i,j=d.length;for(var k=0;k<j;k++)e=d[k],e!==a&&(this.delta.copy(e.p),this.delta.sub(a.p),f=this.delta.lengthSq(),distance=a.radius+e.radius,f<=distance*distance&&(g=distance-Math.sqrt(f),g+=.5,totalMass=a.mass+e.mass,h=this.mass?e.mass/totalMass:.5,i=this.mass?a.mass/totalMass:.5,a.p.add(this.delta.clone().normalize().multiplyScalar(g*-h)),e.p.add(this.delta.normalize().multiplyScalar(g*i)),this.callback&&this.callback(a,e)))},a.Collision=I,a.Util.inherits(J,a.Behaviour),J.prototype.reset=function(b,c,d,e){this.zone=b,this.zone.crossType=a.Util.initValue(c,"dead"),d&&J._super_.prototype.reset.call(this,d,e)},J.prototype.applyBehaviour=function(a,b,c){J._super_.prototype.applyBehaviour.call(this,a,b,c),this.zone.crossing(a)},a.CrossZone=J,a.Util.inherits(K,a.Behaviour),K.prototype.reset=function(b,c,d,e){c==null||c==undefined?this.same=!0:this.same=!1,this.a=a.Util.setSpanValue(a.Util.initValue(b,1)),this.b=a.Util.setSpanValue(c),d&&K._super_.prototype.reset.call(this,d,e)},K.prototype.initialize=function(a){a.transform.alphaA=this.a.getValue(),this.same?a.transform.alphaB=a.transform.alphaA:a.transform.alphaB=this.b.getValue()},K.prototype.applyBehaviour=function(a,b,c){K._super_.prototype.applyBehaviour.call(this,a,b,c),a.alpha=a.transform.alphaB+(a.transform.alphaA-a.transform.alphaB)*this.energy,a.alpha<.001&&(a.alpha=0)},a.Alpha=K,a.Util.inherits(L,a.Behaviour),L.prototype.reset=function(b,c,d,e){c==null||c==undefined?this.same=!0:this.same=!1,this.a=a.Util.setSpanValue(a.Util.initValue(b,1)),this.b=a.Util.setSpanValue(c),d&&L._super_.prototype.reset.call(this,d,e)},L.prototype.initialize=function(a){a.transform.scaleA=this.a.getValue(),a.transform.oldRadius=a.radius,this.same?a.transform.scaleB=a.transform.scaleA:a.transform.scaleB=this.b.getValue()},L.prototype.applyBehaviour=function(a,b,c){L._super_.prototype.applyBehaviour.call(this,a,b,c),a.scale=a.transform.scaleB+(a.transform.scaleA-a.transform.scaleB)*this.energy,a.scale<1e-4&&(a.scale=0),a.radius=a.transform.oldRadius*a.scale},a.Scale=L,a.Util.inherits(M,a.Behaviour),M.prototype.reset=function(b,c,d,e,f){c==null||c==undefined?this.same=!0:this.same=!1,this.a=a.Util.setSpanValue(a.Util.initValue(b,"Velocity")),this.b=a.Util.setSpanValue(a.Util.initValue(c,0)),this.style=a.Util.initValue(d,"to"),e&&M._super_.prototype.reset.call(this,e,f)},M.prototype.initialize=function(a){a.rotation=this.a.getValue(),a.transform.rotationA=this.a.getValue(),this.same||(a.transform.rotationB=this.b.getValue())},M.prototype.applyBehaviour=function(a,b,c){M._super_.prototype.applyBehaviour.call(this,a,b,c);if(!this.same)this.style=="to"||this.style=="TO"||this.style=="_"?a.rotation+=a.transform.rotationB+(a.transform.rotationA-a.transform.rotationB)*this.energy:a.rotation+=a.transform.rotationB;else if(this.a.a=="V"||this.a.a=="Velocity"||this.a.a=="v")a.rotation=a.getDirection()},a.Rotate=M,a.Util.inherits(N,a.Behaviour),N.prototype.reset=function(a,b,c,d){this.color1=this.setSpanValue(a),this.color2=this.setSpanValue(b),c&&N._super_.prototype.reset.call(this,c,d)},N.prototype.initialize=function(b){b.color=this.color1.getValue(),b.transform.beginRGB=a.Util.hexToRGB(b.color),this.color2&&(b.transform.endRGB=a.Util.hexToRGB(this.color2.getValue()))},N.prototype.applyBehaviour=function(a,b,c){this.color2?(N._super_.prototype.applyBehaviour.call(this,a,b,c),a.transform.rgb.r=a.transform.endRGB.r+(a.transform.beginRGB.r-a.transform.endRGB.r)*this.energy,a.transform.rgb.g=a.transform.endRGB.g+(a.transform.beginRGB.g-a.transform.endRGB.g)*this.energy,a.transform.rgb.b=a.transform.endRGB.b+(a.transform.beginRGB.b-a.transform.endRGB.b)*this.energy,a.transform.rgb.r=parseInt(a.transform.rgb.r,10),a.transform.rgb.g=parseInt(a.transform.rgb.g,10),a.transform.rgb.b=parseInt(a.transform.rgb.b,10)):(a.transform.rgb.r=a.transform.beginRGB.r,a.transform.rgb.g=a.transform.beginRGB.g,a.transform.rgb.b=a.transform.beginRGB.b)},N.prototype.setSpanValue=function(b){return b?b instanceof a.ColorSpan?b:new a.ColorSpan(b):null},a.Color=N,a.Util.inherits(O,a.Behaviour),O.prototype.reset=function(b,c,d,e){this.distanceVec=new a.Vector2D,this.centerPoint=a.Util.initValue(b,new a.Vector2D),this.force=a.Util.initValue(this.normalizeValue(c),100),d&&O._super_.prototype.reset.call(this,d,e)},O.prototype.initialize=function(a){},O.prototype.applyBehaviour=function(a,b,c){this.distanceVec.set(this.centerPoint.x-a.p.x,this.centerPoint.y-a.p.y);var d=this.distanceVec.lengthSq();if(d!=0){var e=this.distanceVec.length(),f=this.force*b/(d*e);a.v.x+=f*this.distanceVec.x,a.v.y+=f*this.distanceVec.y}},a.GravityWell=O,P.ID=0,a.Util.inherits(P,a.Particle),a.EventDispatcher.initialize(P.prototype),P.prototype.emit=function(b,c){this.emitTime=0,this.emitTotalTimes=a.Util.initValue(b,Infinity),c==!0||c=="life"||c=="destroy"?b=="once"?this.life=1:this.life=this.emitTotalTimes:isNaN(c)||(this.life=c),this.rate.init()},P.prototype.stopEmit=function(){this.emitTotalTimes=-1,this.emitTime=0},P.prototype.removeAllParticles=function(){for(var a=0;a<this.particles.length;a++)this.particles[a].dead=!0},P.prototype.createParticle=function(b,c){var d=a.pool.get(a.Particle);this.setupParticle(d,b,c),this.dispatchEvent(a.PARTICLE_CREATED,d);return d},P.prototype.addSelfInitialize=function(a){a.init?a.init(this):this.initAll()},P.prototype.addInitialize=function(){var a=arguments.length,b;for(b=0;b<a;b++)this.initializes.push(arguments[b])},P.prototype.removeInitialize=function(a){var b=this.initializes.indexOf(a);b>-1&&this.initializes.splice(b,1)},P.prototype.removeInitializers=function(){a.Util.destroyArray(this.initializes)},P.prototype.addBehaviour=function(){var a=arguments.length,b;for(b=0;b<a;b++)this.behaviours.push(arguments[b]),arguments[b].hasOwnProperty("parents")&&arguments[b].parents.push(this)},P.prototype.removeBehaviour=function(a){var b=this.behaviours.indexOf(a);b>-1&&this.behaviours.splice(b,1)},P.prototype.removeAllBehaviours=function(){a.Util.destroyArray(this.behaviours)},P.prototype.integrate=function(b){var c=1-this.damping;a.integrator.integrate(this,b,c);var d=this.particles.length,e;for(e=0;e<d;e++){var f=this.particles[e];f.update(b,e),a.integrator.integrate(f,b,c),this.dispatchEvent(a.PARTICLE_UPDATE,f)}},P.prototype.emitting=function(a){if(this.emitTotalTimes=="once"){var b=this.rate.getValue(99999),c;for(c=0;c<b;c++)this.createParticle();this.emitTotalTimes="none"}else if(!isNaN(this.emitTotalTimes)){this.emitTime+=a;if(this.emitTime<this.emitTotalTimes){var b=this.rate.getValue(a),c;for(c=0;c<b;c++)this.createParticle()}}},P.prototype.update=function(b){this.age+=b,(this.age>=this.life||this.dead)&&this.destroy(),this.emitting(b),this.integrate(b);var c,d=this.particles.length,e;for(e=d-1;e>=0;e--)c=this.particles[e],c.dead&&(this.dispatchEvent(a.PARTICLE_DEAD,c),a.pool.set(c),this.particles.splice(e,1))},P.prototype.setupParticle=function(b,c,d){var e=this.initializes,f=this.behaviours;c&&(c instanceof Array?e=c:e=[c]),d&&(d instanceof Array?f=d:f=[d]),b.reset(),a.InitializeUtil.initialize(this,b,e),b.addBehaviours(f),b.parent=this,this.particles.push(b)},P.prototype.destroy=function(){this.dead=!0,this.emitTotalTimes=-1,this.particles.length==0&&(this.removeInitializers(),this.removeAllBehaviours(),this.parent&&this.parent.removeEmitter(this))},a.Emitter=P,a.Util.inherits(Q,a.Emitter),Q.prototype.addSelfBehaviour=function(){var a=arguments.length,b;for(b=0;b<a;b++)this.selfBehaviours.push(arguments[b])},Q.prototype.removeSelfBehaviour=function(a){var b=this.selfBehaviours.indexOf(a);b>-1&&this.selfBehaviours.splice(b,1)},Q.prototype.update=function(a){Q._super_.prototype.update.call(this,a);if(!this.sleep){var b=this.selfBehaviours.length,c;for(c=0;c<b;c++)this.selfBehaviours[c].applyBehaviour(this,a,c)}},a.BehaviourEmitter=Q,a.Util.inherits(R,a.Emitter),R.prototype.initEventHandler=function(){var a=this;this.mousemoveHandler=function(b){a.mousemove.call(a,b)},this.mousedownHandler=function(b){a.mousedown.call(a,b)},this.mouseupHandler=function(b){a.mouseup.call(a,b)},this.mouseTarget.addEventListener("mousemove",this.mousemoveHandler,!1)},R.prototype.emit=function(){this._allowEmitting=!0},R.prototype.stopEmit=function(){this._allowEmitting=!1},R.prototype.mousemove=function(a){if(a.layerX||a.layerX==0)this.p.x+=(a.layerX-this.p.x)*this.ease,this.p.y+=(a.layerY-this.p.y)*this.ease;else if(a.offsetX||a.offsetX==0)this.p.x+=(a.offsetX-this.p.x)*this.ease,this.p.y+=(a.offsetY-this.p.y)*this.ease;this._allowEmitting&&R._super_.prototype.emit.call(this,"once")},R.prototype.destroy=function(){R._super_.prototype.destroy.call(this),this.mouseTarget.removeEventListener("mousemove",this.mousemoveHandler,!1)},a.FollowEmitter=R;var S=S||{easeLinear:function(a){return a},easeInQuad:function(a){return Math.pow(a,2)},easeOutQuad:function(a){return-(Math.pow(a-1,2)-1)},easeInOutQuad:function(a){if((a/=.5)<1)return.5*Math.pow(a,2);return-0.5*((a-=2)*a-2)},easeInCubic:function(a){return Math.pow(a,3)},easeOutCubic:function(a){return Math.pow(a-1,3)+1},easeInOutCubic:function(a){if((a/=.5)<1)return.5*Math.pow(a,3);return.5*(Math.pow(a-2,3)+2)},easeInQuart:function(a){return Math.pow(a,4)},easeOutQuart:function(a){return-(Math.pow(a-1,4)-1)},easeInOutQuart:function(a){if((a/=.5)<1)return.5*Math.pow(a,4);return-0.5*((a-=2)*Math.pow(a,3)-2)},easeInSine:function(a){return-Math.cos(a*(Math.PI/2))+1},easeOutSine:function(a){return Math.sin(a*(Math.PI/2))},easeInOutSine:function(a){return-0.5*(Math.cos(Math.PI*a)-1)},easeInExpo:function(a){return a===0?0:Math.pow(2,10*(a-1))},easeOutExpo:function(a){return a===1?1:-Math.pow(2,-10*a)+1},easeInOutExpo:function(a){if(a===0)return 0;if(a===1)return 1;if((a/=.5)<1)return.5*Math.pow(2,10*(a-1));return.5*(-Math.pow(2,-10*--a)+2)},easeInCirc:function(a){return-(Math.sqrt(1-a*a)-1)},easeOutCirc:function(a){return Math.sqrt(1-Math.pow(a-1,2))},easeInOutCirc:function(a){if((a/=.5)<1)return-0.5*(Math.sqrt(1-a*a)-1);return.5*(Math.sqrt(1-(a-=2)*a)+1)},easeInBack:function(a){var b=1.70158;return a*a*((b+1)*a-b)},easeOutBack:function(a){var b=1.70158;return(a=a-1)*a*((b+1)*a+b)+1},easeInOutBack:function(a){var b=1.70158;if((a/=.5)<1)return.5*a*a*(((b*=1.525)+1)*a-b);return.5*((a-=2)*a*(((b*=1.525)+1)*a+b)+2)},setEasingByName:function(a){return S[a]?S[a]:S.easeLinear}};for(var T in S)T!="setEasingByName"&&(a[T]=S[T]);a.ease=S,U.prototype={start:function(){this.addEventHandler(),this.renderer.start()},stop:function(){this.renderer.stop()},resize:function(a,b){this.renderer.resize(a,b)},setStroke:function(a,b){this.renderer.hasOwnProperty("stroke")?this.renderer.setStroke(a,b):alert("Sorry this renderer do not suppest stroke method!")},createImageData:function(b){this.renderer instanceof a.PixelRender&&this.renderer.createImageData(b)},setMaxRadius:function(b){this.renderer instanceof a.WebGLRender&&this.renderer.setMaxRadius(b)},blendEquation:function(b){this.renderer instanceof a.WebGLRender&&this.renderer.blendEquation(b)},blendFunc:function(b,c){this.renderer instanceof a.WebGLRender&&this.renderer.blendFunc(b,c)},setType:function(a){this.type=a,this.renderer=this.getRenderer()},getRenderer:function(){switch(this.type){case"pixi":return new a.PixiRender(this.proton,this.element);case"dom":return new a.DomRender(this.proton,this.element);case"canvas":return new a.CanvasRender(this.proton,this.element);case"webgl":return new a.WebGLRender(this.proton,this.element);case"easel":return new a.EaselRender(this.proton,this.element);case"easeljs":return new a.EaselRender(this.proton,this.element);case"pixel":return new a.PixelRender(this.proton,this.element);default:return new a.BaseRender(this.proton,this.element)}},render:function(a){this.renderer.render(a)},addEventHandler:function(){this.onProtonUpdate&&(this.renderer.onProtonUpdate=this.onProtonUpdate),this.onParticleCreated&&(this.renderer.onParticleCreated=this.onParticleCreated),this.onParticleUpdate&&(this.renderer.onParticleUpdate=this.onParticleUpdate),this.onParticleDead&&(this.renderer.onParticleDead=this.onParticleDead)}},a.Renderer=U,V.prototype={start:function(){var b=this;this.proton.addEventListener(a.PROTON_UPDATE,function(){b.onProtonUpdate.call(b)}),this.proton.addEventListener(a.PROTON_UPDATE_AFTER,function(){b.onProtonUpdateAfter.call(b)}),this.proton.addEventListener(a.EMITTER_ADDED,function(a){b.onEmitterAdded.call(b,a)}),this.proton.addEventListener(a.EMITTER_REMOVED,function(a){b.onEmitterRemoved.call(b,a)});var c=this.proton.emitters.length,d;for(d=0;d<c;d++){var e=this.proton.emitters[d];this.addEmitterListener(e)}},resize:function(a,b){},addEmitterListener:function(b){var c=this;b.addEventListener(a.PARTICLE_CREATED,function(a){c.onParticleCreated.call(c,a)}),b.addEventListener(a.PARTICLE_UPDATE,function(a){c.onParticleUpdate.call(c,a)}),b.addEventListener(a.PARTICLE_DEAD,function(a){c.onParticleDead.call(c,a)})},stop:function(){var a=this.proton.emitters.length,b;this.proton.removeAllEventListeners();for(b=0;b<a;b++){var c=this.proton.emitters[b];c.removeAllEventListeners()}},onEmitterAdded:function(a){this.addEmitterListener(a)},onEmitterRemoved:function(a){a.removeAllEventListeners()},onProtonUpdate:function(){},onProtonUpdateAfter:function(){},onParticleCreated:function(a){},onParticleUpdate:function(a){},onParticleDead:function(a){}},a.BaseRender=V,a.Util.inherits(W,a.BaseRender),W.prototype.start=function(){W._super_.prototype.start.call(this)},W.prototype.setStroke=function(b,c){b=a.Util.initValue(b,"#000000"),c=a.Util.initValue(c,1),this.stroke={color:b,thinkness:c}},W.prototype.onProtonUpdate=function(){},W.prototype.onParticleCreated=function(b){if(b.target){var c=this;a.Util.getImage(b.target,b,!1,function(a){c.setImgInDIV.call(c,a)})}else b.transform.canvas=a.DomUtil.createCanvas(b.id+"_canvas",b.radius+1,b.radius+1,"absolute"),b.transform.bakOldRadius=b.radius,this.stroke?(b.transform.canvas.width=2*b.radius+this.stroke.thinkness*2,b.transform.canvas.height=2*b.radius+this.stroke.thinkness*2):(b.transform.canvas.width=2*b.radius+1,b.transform.canvas.height=2*b.radius+1),b.transform.context=b.transform.canvas.getContext("2d"),b.transform.context.fillStyle=b.color,b.transform.context.beginPath(),b.transform.context.arc(b.radius,b.radius,b.radius,0,Math.PI*2,!0),this.stroke&&(b.transform.context.strokeStyle=this.stroke.color,b.transform.context.lineWidth=this.stroke.thinkness,b.transform.context.stroke()),b.transform.context.closePath(),b.transform.context.fill(),this.element.appendChild(b.transform.canvas)},W.prototype.onParticleUpdate=function(b){b.target?b.target instanceof Image&&(b.transform.canvas.style.opacity=b.alpha,a.DomUtil.transformDom(b.transform.canvas,b.p.x-b.target.width/2,b.p.y-b.target.height/2,b.scale,b.rotation)):(b.transform.canvas.style.opacity=b.alpha,b.transform.oldRadius?a.DomUtil.transformDom(b.transform.canvas,b.p.x-b.transform.oldRadius,b.p.y-b.transform.oldRadius,b.scale,b.rotation):a.DomUtil.transformDom(b.transform.canvas,b.p.x-b.transform.bakOldRadius,b.p.y-b.transform.bakOldRadius,b.scale,b.rotation))},W.prototype.onParticleDead=function(a){a.transform.canvas&&this.element.removeChild(a.transform.canvas)},W.prototype.setImgInDIV=function(b){b.transform.canvas=a.DomUtil.createCanvas(b.id+"_canvas",b.target.width+1,b.target.height+1,"absolute",b.p.x-b.radius,b.p.y-b.radius),b.transform.context=b.transform.canvas.getContext("2d"),b.transform.context.drawImage(b.target,0,0,b.target.width,b.target.height),this.element.appendChild(b.transform.canvas)},a.DomRender=W,a.Util.inherits(X,a.BaseRender),X.prototype.resize=function(a,b){},X.prototype.start=function(){X._super_.prototype.start.call(this)},X.prototype.onProtonUpdate=function(){},X.prototype.onParticleCreated=function(a){if(a.target)a.target=this.pool.get(a.target),a.target.parent||(!a.target.image||(a.target.regX=a.target.image.width/2,a.target.regY=a.target.image.height/2),this.element.addChild(a.target));else{var b=this.pool.get(createjs.Graphics);this.stroke&&(this.stroke==!0?b.beginStroke("#000000"):this.stroke instanceof String&&b.beginStroke(this.stroke)),b.beginFill(a.color).drawCircle(0,0,a.radius);var c=new createjs.Shape(b);a.target=c,this.element.addChild(a.target)}},X.prototype.onParticleUpdate=function(a){a.target&&(a.target.x=a.p.x,a.target.y=a.p.y,a.target.alpha=a.alpha,a.target.scaleX=a.target.scaleY=a.scale,a.target.rotation=a.rotation)},X.prototype.onParticleDead=function(a){a.target&&(a.target.parent&&a.target.parent.removeChild(a.target),this.pool.set(a.target),a.target=null)},a.EaselRender=X,a.Util.inherits(Y,a.BaseRender),Y.prototype.resize=function(a,b){this.element.width=a,this.element.height=b},Y.prototype.start=function(){Y._super_.prototype.start.call(this)},Y.prototype.setStroke=function(b,c){b=a.Util.initValue(b,"#000000"),c=a.Util.initValue(c,1),this.stroke={color:b,thinkness:c}},Y.prototype.onProtonUpdate=function(){this.context.clearRect(0,0,this.element.width,this.element.height)},Y.prototype.onParticleCreated=function(b){b.target?a.Util.getImage(b.target,b,!1):b.color=b.color?b.color:"#ff0000"},Y.prototype.onParticleUpdate=function(b){if(b.target){if(b.target instanceof Image){var c=b.target.width*b.scale|0,d=b.target.height*b.scale|0,e=b.p.x-c/2,f=b.p.y-d/2;if(!b.color)this.context.save(),this.context.globalAlpha=b.alpha,this.context.translate(b.p.x,b.p.y),this.context.rotate(a.MathUtils.degreeTransform(b.rotation)),this.context.translate(-b.p.x,-b.p.y),this.context.drawImage(b.target,0,0,b.target.width,b.target.height,e,f,c,d),this.context.globalAlpha=1,this.context.restore();else{b.transform.buffer||(b.transform.buffer=this.getBuffer(b.target));var g=b.transform.buffer.getContext("2d");g.clearRect(0,0,b.transform.buffer.width,b.transform.buffer.height),g.globalAlpha=b.alpha,g.drawImage(b.target,0,0),g.globalCompositeOperation="source-atop",g.fillStyle=a.Util.rgbToHex(b.transform.rgb),g.fillRect(0,0,b.transform.buffer.width,b.transform.buffer.height),g.globalCompositeOperation="source-over",g.globalAlpha=1,this.context.drawImage(b.transform.buffer,0,0,b.transform.buffer.width,b.transform.buffer.height,e,f,c,d)}}}else b.transform.rgb?this.context.fillStyle="rgba("+b.transform.rgb.r+","+b.transform.rgb.g+","+b.transform.rgb.b+","+b.alpha+")":this.context.fillStyle=b.color,this.context.beginPath(),this.context.arc(b.p.x,b.p.y,b.radius,0,Math.PI*2,!0),this.stroke&&(this.context.strokeStyle=this.stroke.color,this.context.lineWidth=this.stroke.thinkness,this.context.stroke()),this.context.closePath(),this.context.fill()},Y.prototype.onParticleDead=function(a){},Y.prototype.getBuffer=function(a){if(a instanceof Image){var b=a.width+"_"+a.height,c=this.bufferCache[b];c||(c=document.createElement("canvas"),c.width=a.width,c.height=a.height,this.bufferCache[b]=c);return c}},a.CanvasRender=Y,a.Util.inherits(Z,a.BaseRender),Z.prototype.resize=function(a,b){this.element.width=a,this.element.height=b},Z.prototype.createImageData=function(b){b?this.rectangle=b:this.rectangle=new a.Rectangle(0,0,this.element.width,this.element.height),this.imageData=this.context.createImageData(this.rectangle.width,this.rectangle.height),this.context.putImageData(this.imageData,this.rectangle.x,this.rectangle.y)},Z.prototype.start=function(){Z._super_.prototype.start.call(this)},Z.prototype.onProtonUpdate=function(){this.context.clearRect(this.rectangle.x,this.rectangle.y,this.rectangle.width,this.rectangle.height),this.imageData=this.context.getImageData(this.rectangle.x,this.rectangle.y,this.rectangle.width,this.rectangle.height)},Z.prototype.onProtonUpdateAfter=function(){this.context.putImageData(this.imageData,this.rectangle.x,this.rectangle.y)},Z.prototype.onParticleCreated=function(a){},Z.prototype.onParticleUpdate=function(a){this.imageData&&this.setPixel(this.imageData,Math.floor(a.p.x-this.rectangle.x),Math.floor(a.p.y-this.rectangle.y),a)},Z.prototype.setPixel=function(a,b,c,d){var e=d.transform.rgb;if(!(b<0||b>this.element.width||c<0||c>this.elementwidth)){var f=((c>>0)*a.width+(b>>0))*4;a.data[f]=e.r,a.data[f+1]=e.g,a.data[f+2]=e.b,a.data[f+3]=d.alpha*255}},Z.prototype.onParticleDead=function(a){},a.PixelRender=Z,a.Util.inherits($,a.BaseRender),$.prototype.resize=function(a,b){this.umat[4]=-2,this.umat[7]=1,this.smat[0]=1/a,this.smat[4]=1/b,this.mstack.set(this.umat,0),this.mstack.set(this.smat,1),this.gl.viewport(0,0,a,b),this.element.width=a,this.element.height=b},$.prototype.setMaxRadius=function(a){this.circleCanvasURL=this.createCircle(a)},$.prototype.getVertexShader=function(){var a=["uniform vec2 viewport;","attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 tMat;","varying vec2 vTextureCoord;","varying float alpha;","void main() {","vec3 v = tMat * vec3(aVertexPosition, 1.0);","gl_Position = vec4(v.x, v.y, 0, 1);","vTextureCoord = aTextureCoord;","alpha = tMat[0][2];","}"].join("\n");return a},$.prototype.getFragmentShader=function(){var a=["precision mediump float;","varying vec2 vTextureCoord;","varying float alpha;","uniform sampler2D uSampler;","uniform vec4 color;","uniform bool useTexture;","uniform vec3 uColor;","void main() {","vec4 textureColor = texture2D(uSampler, vTextureCoord);","gl_FragColor = textureColor * vec4(uColor, 1.0);","gl_FragColor.w *= alpha;","}"].join("\n");return a},$.prototype.initVar=function(){this.mstack=new a.MStack,this.umat=a.Mat3.create([2,0,1,0,-2,0,-1,1,1]),this.smat=a.Mat3.create([.01,0,1,0,.01,0,0,0,1]),this.texturebuffers={}},$.prototype.start=function(){$._super_.prototype.start.call(this),this.resize(this.element.width,this.element.height)},$.prototype.blendEquation=function(a){this.gl.blendEquation(this.gl[a])},$.prototype.blendFunc=function(a,b){this.gl.blendFunc(this.gl[a],this.gl[b])},$.prototype.getShader=function(a,b,c){var d;c?d=a.createShader(a.FRAGMENT_SHADER):d=a.createShader(a.VERTEX_SHADER),a.shaderSource(d,b),a.compileShader(d);if(!a.getShaderParameter(d,a.COMPILE_STATUS)){alert(a.getShaderInfoLog(d));return null}return d},$.prototype.initShaders=function(){var a=this.getShader(this.gl,this.getFragmentShader(),!0),b=this.getShader(this.gl,this.getVertexShader(),!1);this.sprogram=this.gl.createProgram(),this.gl.attachShader(this.sprogram,b),this.gl.attachShader(this.sprogram,a),this.gl.linkProgram(this.sprogram),this.gl.getProgramParameter(this.sprogram,this.gl.LINK_STATUS)||alert("Could not initialise shaders"),this.gl.useProgram(this.sprogram),this.sprogram.vpa=this.gl.getAttribLocation(this.sprogram,"aVertexPosition"),this.sprogram.tca=this.gl.getAttribLocation(this.sprogram,"aTextureCoord"),this.gl.enableVertexAttribArray(this.sprogram.tca),this.gl.enableVertexAttribArray(this.sprogram.vpa),this.sprogram.tMatUniform=this.gl.getUniformLocation(this.sprogram,"tMat"),this.sprogram.samplerUniform=this.gl.getUniformLocation(this.sprogram,"uSampler"),this.sprogram.useTex=this.gl.getUniformLocation(this.sprogram,"useTexture"),this.sprogram.color=this.gl.getUniformLocation(this.sprogram,"uColor"),this.gl.uniform1i(this.sprogram.useTex,1)},$.prototype.initBuffers=function(){this.unitIBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.unitIBuffer);var a=[0,3,1,0,2,3];this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(a),this.gl.STATIC_DRAW);var b=[];for(var c=0;c<100;c++)b.push(c);idx=new Uint16Array(b),this.unitI33=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.unitI33),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,idx,this.gl.STATIC_DRAW),b=[];for(c=0;c<100;c++)b.push(c,c+1,c+2);idx=new Uint16Array(b),this.stripBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.stripBuffer),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,idx,this.gl.STATIC_DRAW)},$.prototype.createCircle=function(b){this.circleCanvasRadius=a.WebGLUtil.nhpot(a.Util.initValue(b,32));var c=a.DomUtil.createCanvas("circle_canvas",this.circleCanvasRadius*2,this.circleCanvasRadius*2),d=c.getContext("2d");d.beginPath(),d.arc(this.circleCanvasRadius,this.circleCanvasRadius,this.circleCanvasRadius,0,Math.PI*2,!0),d.closePath(),d.fillStyle="#FFF",d.fill();return c.toDataURL()},$.prototype.setImgInCanvas=function(b){var c=b.target.width,d=b.target.height,e=a.WebGLUtil.nhpot(b.target.width),f=a.WebGLUtil.nhpot(b.target.height),g=b.target.width/e,h=b.target.height/f;this.texturebuffers[b.transform.src]||(this.texturebuffers[b.transform.src]=[this.gl.createTexture(),this.gl.createBuffer(),this.gl.createBuffer()]),b.transform.texture=this.texturebuffers[b.transform.src][0],b.transform.vcBuffer=this.texturebuffers[b.transform.src][1],b.transform.tcBuffer=this.texturebuffers[b.transform.src][2],this.gl.bindBuffer(this.gl.ARRAY_BUFFER,b.transform.tcBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array([0,0,g,0,0,h,h,h]),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,b.transform.vcBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array([0,0,c,0,0,d,c,d]),this.gl.STATIC_DRAW);var i=b.transform.canvas.getContext("2d"),j=i.getImageData(0,0,e,f);this.gl.bindTexture(this.gl.TEXTURE_2D,b.transform.texture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,j),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_NEAREST),this.gl.generateMipmap(this.gl.TEXTURE_2D),b.transform.textureLoaded=!0,b.transform.textureWidth=c,b.transform.textureHeight=d},$.prototype.setStroke=function(a,b){},$.prototype.onProtonUpdate=function(){},$.prototype.onParticleCreated=function(b){var c=this;b.transform.textureLoaded=!1,b.transform.tmat=a.Mat3.create(),b.transform.tmat[8]=1,b.transform.imat=a.Mat3.create(),b.transform.imat[8]=1,b.target?a.Util.getImage(b.target,b,!0,function(a){c.setImgInCanvas.call(c,a),a.transform.oldScale=1}):a.Util.getImage(this.circleCanvasURL,b,!0,function(a){c.setImgInCanvas.call(c,a),a.transform.oldScale=a.radius/c.circleCanvasRadius})},$.prototype.onParticleUpdate=function(a){a.transform.textureLoaded&&(this.updateMatrix(a),this.gl.uniform3f(this.sprogram.color,a.transform.rgb.r/255,a.transform.rgb.g/255,a.transform.rgb.b/255),this.gl.uniformMatrix3fv(this.sprogram.tMatUniform,!1,this.mstack.top()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,a.transform.vcBuffer),this.gl.vertexAttribPointer(this.sprogram.vpa,2,this.gl.FLOAT,!1,0,0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,a.transform.tcBuffer),this.gl.vertexAttribPointer(this.sprogram.tca,2,this.gl.FLOAT,!1,0,0),this.gl.bindTexture(this.gl.TEXTURE_2D,a.transform.texture),this.gl.uniform1i(this.sprogram.samplerUniform,0),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.unitIBuffer),this.gl.drawElements(this.gl.TRIANGLES,6,this.gl.UNSIGNED_SHORT,0),this.mstack.pop())},$.prototype.onParticleDead=function(a){},$.prototype.updateMatrix=function(b){var c=a.WebGLUtil.makeTranslation(-b.transform.textureWidth/2,-b.transform.textureHeight/2),d=a.WebGLUtil.makeTranslation(b.p.x,b.p.y),e=b.rotation*(Math.PI/180),f=a.WebGLUtil.makeRotation(e),g=b.scale*b.transform.oldScale,h=a.WebGLUtil.makeScale(g,g),i=a.WebGLUtil.matrixMultiply(c,h);i=a.WebGLUtil.matrixMultiply(i,f),i=a.WebGLUtil.matrixMultiply(i,d),a.Mat3.inverse(i,b.transform.imat),i[2]=b.alpha,this.mstack.push(i)},a.WebGLRender=$,_.prototype={getPosition:function(){},crossing:function(a){}},a.Zone=_,a.Util.inherits(ba,a.Zone),ba.prototype.getPosition=function(){this.random=Math.random(),this.vector.x=this.x1+this.random*this.length*Math.cos(this.gradient),this.vector.y=this.y1+this.random*this.length*Math.sin(this.gradient);return this.vector},ba.prototype.getDirection=function(a,b){var c=this.dy,d=-this.dx,e=this.dot,f=d==0?1:d;return(c*a+d*b+e)*f>0?!0:!1},ba.prototype.getDistance=function(a,b){var c=this.dy,d=-this.dx,e=this.dot,f=c*a+d*b+e;return f/Math.sqrt(this.xxyy)},ba.prototype.getSymmetric=function(a){var b=a.getGradient(),c=this.getGradient(),d=2*(c-b),e=a.x,f=a.y;a.x=e*Math.cos(d)-f*Math.sin(d),a.y=e*Math.sin(d)+f*Math.cos(d);return a},ba.prototype.getGradient=function(){return Math.atan2(this.dy,this.dx)},ba.prototype.getRange=function(a,b){var c=Math.abs(this.getGradient());c<=Math.PI/4?a.p.x<this.maxx&&a.p.x>this.minx&&b():a.p.y<this.maxy&&a.p.y>this.miny&&b()},ba.prototype.getLength=function(){return Math.sqrt(this.dx*this.dx+this.dy*this.dy)},ba.prototype.crossing=function(a){var b=this;this.crossType=="dead"?this.direction==">"||this.direction=="R"||this.direction=="right"||this.direction=="down"?this.getRange(a,function(){b.getDirection(a.p.x,a.p.y)&&(a.dead=!0)}):this.getRange(a,function(){b.getDirection(a.p.x,a.p.y)||(a.dead=!0)}):this.crossType=="bound"?this.getRange(a,function(){b.getDistance(a.p.x,a.p.y)<=a.radius&&(b.dx==0?a.v.x*=-1:b.dy==0?a.v.y*=-1:b.getSymmetric(a.v))}):this.crossType=="cross"&&this.alert&&(alert("Sorry lineZone does not support cross method"),this.alert=!1)},a.LineZone=ba,a.Util.inherits(bb,a.Zone),bb.prototype.getPosition=function(){this.random=Math.random(),this.angle=Math.PI*2*Math.random(),this.vector.x=this.x+this.random*this.radius*Math.cos(this.angle),this.vector.y=this.y+this.random*this.radius*Math.sin(this.angle);return this.vector},bb.prototype.setCenter=function(a,b){this.center.x=a,this.center.y=b},bb.prototype.crossing=function(a){var b=a.p.distanceTo(this.center);this.crossType=="dead"?b-a.radius>this.radius&&(a.dead=!0):this.crossType=="bound"?b+a.radius>=this.radius&&this.getSymmetric(a):this.crossType=="cross"&&this.alert&&(alert("Sorry CircleZone does not support cross method"),this.alert=!1)},bb.prototype.getSymmetric=function(a){var b=a.v.getGradient(),c=this.getGradient(a),d=2*(c-b),e=a.v.x,f=a.v.y;a.v.x=e*Math.cos(d)-f*Math.sin(d),a.v.y=e*Math.sin(d)+f*Math.cos(d)},bb.prototype.getGradient=function(a){return-Math.PI/2+Math.atan2(a.p.y-this.center.y,a.p.x-this.center.x)},a.CircleZone=bb,a.Util.inherits(bc,a.Zone),bc.prototype.getPosition=function(){this.vector.x=this.x,this.vector.y=this.y;return this.vector},bc.prototype.crossing=function(a){this.alert&&(alert("Sorry PointZone does not support crossing method"),this.alert=!1)},a.PointZone=bc,a.Util.inherits(bd,a.Zone),bd.prototype.getPosition=function(){this.vector.x=this.x+Math.random()*this.width,this.vector.y=this.y+Math.random()*this.height;return this.vector},bd.prototype.crossing=function(a){this.crossType=="dead"?(a.p.x+a.radius<this.x?a.dead=!0:a.p.x-a.radius>this.x+this.width&&(a.dead=!0),a.p.y+a.radius<this.y?a.dead=!0:a.p.y-a.radius>this.y+this.height&&(a.dead=!0)):this.crossType=="bound"?(a.p.x-a.radius<this.x?(a.p.x=this.x+a.radius,a.v.x*=-1):a.p.x+a.radius>this.x+this.width&&(a.p.x=this.x+this.width-a.radius,a.v.x*=-1),a.p.y-a.radius<this.y?(a.p.y=this.y+a.radius,a.v.y*=-1):a.p.y+a.radius>this.y+this.height&&(a.p.y=this.y+this.height-a.radius,a.v.y*=-1)):this.crossType=="cross"&&(a.p.x+a.radius<this.x&&a.v.x<=0?a.p.x=this.x+this.width+a.radius:a.p.x-a.radius>this.x+this.width&&a.v.x>=0&&(a.p.x=this.x-a.radius),a.p.y+a.radius<this.y&&a.v.y<=0?a.p.y=this.y+this.height+a.radius:a.p.y-a.radius>this.y+this.height&&a.v.y>=0&&(a.p.y=this.y-a.radius))},a.RectZone=bd,a.Util.inherits(be,a.Zone),be.prototype.reset=function(b,c,d,e){this.imageData=b,this.x=a.Util.initValue(c,0),this.y=a.Util.initValue(d,0),this.d=a.Util.initValue(e,2),this.vectors=[],this.setVectors()},be.prototype.setVectors=function(){var a,b,c=this.imageData.width,d=this.imageData.height;for(a=0;a<c;a+=this.d)for(b=0;b<d;b+=this.d){var e=((b>>0)*c+(a>>0))*4;this.imageData.data[e+3]>0&&this.vectors.push({x:a+this.x,y:b+this.y})}return this.vector},be.prototype.getBound=function(a,b){var c=((b>>0)*this.imageData.width+(a>>0))*4;return this.imageData.data[c+3]>0?!0:!1},be.prototype.getPosition=function(){return this.vector.copy(this.vectors[Math.floor(Math.random()*this.vectors.length)])},be.prototype.getColor=function(a,b){a-=this.x,b-=this.y;var c=((b>>0)*this.imageData.width+(a>>0))*4;return{r:this.imageData.data[c],g:this.imageData.data[c+1],b:this.imageData.data[c+2],a:this.imageData.data[c+3]}},be.prototype.crossing=function(a){this.crossType=="dead"?this.getBound(a.p.x-this.x,a.p.y-this.y)?a.dead=!0:a.dead=!1:this.crossType=="bound"&&(this.getBound(a.p.x-this.x,a.p.y-this.y)||a.v.negate())},a.ImageZone=be;var bf=bf||{addEventListener:function(b,c){b.addEventListener(a.PROTON_UPDATE,function(){c()})},setStyle:function(b){var c=b||"#ff0000",d=a.Util.hexToRGB(c),e="rgba("+d.r+","+d.g+","+d.b+","+.5+")";return e},drawZone:function(b,c,d,e){var f=c.getContext("2d"),g=this.setStyle();this.addEventListener(b,function(){e&&f.clearRect(0,0,c.width,c.height),d instanceof a.PointZone?(f.beginPath(),f.fillStyle=g,f.arc(d.x,d.y,10,0,Math.PI*2,!0),f.fill(),f.closePath()):d instanceof a.LineZone?(f.beginPath(),f.strokeStyle=g,f.moveTo(d.x1,d.y1),f.lineTo(d.x2,d.y2),f.stroke(),f.closePath()):d instanceof a.RectZone?(f.beginPath(),f.strokeStyle=g,f.drawRect(d.x,d.y,d.width,d.height),f.stroke(),f.closePath()):d instanceof a.CircleZone&&(f.beginPath(),f.strokeStyle=g,f.arc(d.x,d.y,d.radius,0,Math.PI*2,!0),f.stroke(),f.closePath())})},drawEmitter:function(a,b,c,d){var e=b.getContext("2d"),f=this.setStyle();this.addEventListener(a,function(){d&&e.clearRect(0,0,b.width,b.height),e.beginPath(),e.fillStyle=f,e.arc(c.p.x,c.p.y,10,0,Math.PI*2,!0),e.fill(),e.closePath()})},test:{},setTest:function(a,b){this.test[a]=b},getTest:function(a){return this.test.hasOwnProperty(a)?this.test[a]:!1}};a.Debug=bf,function(){var a=0,b=["ms","moz","webkit","o"];for(var c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b,c){var d=(new Date).getTime(),e=Math.max(0,16-(d-a)),f=window.setTimeout(function(){b(d+e)},e);a=d+e;return f}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})}();return a})